/*Styles*/
var textStyle={"font-size":"16px"},edgeStyle={"stroke-width":"2px"},angleStyle={fill:"#DDD"},bowlHoverStyle={stroke:"#999",fill:"#ff9"},bowlDefaultStyle={stroke:"#000",fill:"#fff"},bowlDroppedTrueStyle={stroke:"#0f0",fill:"#afa"},bowlDroppedFalseStyle={stroke:"#f00",fill:"#faa"},Interaction=function(){};Interaction(),Interaction.init=function(a){Main.setObjective("Aşağıdaki nesneleri kaç boyutlu olduğuna göre sınıflandırmak için fare ile sürükleyerek ilgili sepete atınız."),Interaction.paper=new Raphael(a,$(a).width(),$(a).height()),Interaction.container=a,Interaction.container.top=$(a).offset().top,Interaction.container.left=$(a).offset().left;var b=Interaction.paper.width,c=Interaction.paper.height;Interaction.generateBowls(b,c),Interaction.nextQuestion()},Interaction.setStatus=function(a){Interaction.status.innerHTML=a},Interaction.highlight=function(a,b){Interaction.droppedBowl=null,Interaction.dim0.attr(bowlDefaultStyle),Interaction.dim1.attr(bowlDefaultStyle),Interaction.dim2.attr(bowlDefaultStyle),Interaction.dim3.attr(bowlDefaultStyle);var c;Interaction.isInBowl(a,b,Interaction.dim0)?c=Interaction.dim0.attr(bowlHoverStyle):Interaction.isInBowl(a,b,Interaction.dim1)?c=Interaction.dim1.attr(bowlHoverStyle):Interaction.isInBowl(a,b,Interaction.dim2)?c=Interaction.dim2.attr(bowlHoverStyle):Interaction.isInBowl(a,b,Interaction.dim3)?c=Interaction.dim3.attr(bowlHoverStyle):c=null,Interaction.droppedBowl=c},Interaction.isInBowl=function(a,b,c){var d=$(Interaction.container).offset();return c.attr("x")+d.left<a&&c.attr("x")+d.left+c.attr("width")>a&&c.attr("y")+d.top<b&&c.attr("y")+d.top+c.attr("height")>b},Interaction.nextQuestion=function(){Interaction.shape!="undefined"&&Interaction.shape!=null&&Interaction.shape.remove(),Interaction.preventDrag=!1;var a=Interaction.paper.width,b=Interaction.paper.height;Interaction.generateRandomShape(.4*a,.19*b,.2*a,.22*b),Interaction.shape.attr({cursor:"move"});var c={move:function(a,b,c,d){if(Interaction.preventDrag)return;var e=this.ox+a,f=this.oy+b;this.translate(a-this.odx,b-this.ody),this.odx=a,this.ody=b,Interaction.highlight(c,d)}},d={move:function(a,b,c,d){if(Interaction.preventDrag)return;var e=this.ox+a,f=this.oy+b;this.attr({cx:e,cy:f}),Interaction.highlight(c,d)}},e=function(){if(Interaction.preventDrag)return;this.isEllipse=this.data("isEllipse")||!1,this.isPath=this.data("isPath")||!1;var a=this.isEllipse?this.attr("cx"):this.attr("x"),b=this.isEllipse?this.attr("cy"):this.attr("y");this.ox=a,this.oy=b,this.odx=0,this.ody=0,this.attr({opacity:.5})},f=function(a,b,c,d){if(Interaction.preventDrag)return;var e=this.ox+a,f=this.oy+b;this.attr({x:e,y:f}),console.log(a,b),Interaction.highlight(c,d)},g=function(){if(Interaction.preventDrag)return;this.attr({opacity:1});if(Interaction.droppedBowl!=null&&Interaction.droppedBowl!="undefined"&&Interaction.shapeDimension==Interaction.droppedBowl.data("dim"))Interaction.preventDrag=!0,Interaction.shape.animate({opacity:0},500),Interaction.droppedBowl.animate(bowlDroppedTrueStyle,500,function(){Interaction.droppedBowl.animate(bowlDefaultStyle,500,function(){Interaction.nextQuestion()})});else{Interaction.preventDrag=!0,Interaction.shape.animate({opacity:1},500);var a=function(){Interaction.preventDrag=!1};Interaction.droppedBowl!=null&&Interaction.droppedBowl!="undefined"&&Interaction.droppedBowl.animate(bowlDroppedFalseStyle,500),this.isEllipse?this.animate({cx:this.ox,cy:this.oy,delay:500},500,a):this.isPath?this.animate({transform:"T"+ -this.odx+" "+ -this.ody+" ...",delay:500},500,a):this.animate({x:this.ox,y:this.oy,delay:500},500,a)}};Interaction.shape.data("isEllipse")?Interaction.shape.drag(d.move,e,g):Interaction.shape.data("isPath")?Interaction.shape.drag(c.move,e,g):Interaction.shape.drag(f,e,g)},Interaction.generateRandomShape=function(a,b,c,d){Interaction.shapeDimension=Math.floor(Math.random()*4);switch(Interaction.shapeDimension){case 0:var e=Math.min(c,d);Interaction.shape=Interaction.paper.circle(a+c*.5,b+d*.5,5).attr({fill:"#000",stroke:"#000"}).data("isEllipse",!0);break;case 1:switch(Math.floor(Math.random()*4)){case 0:Interaction.shape=Interaction.paper.rect(a+c*.2,b+d*.2,c*.6,d*.6).attr(edgeStyle).data("isEllipse",!1).data("isPath",!1);break;case 1:var f=Math.min(c,d)*.5;Interaction.shape=Interaction.paper.circle(a+c*.5,b+d*.5,f).data("isEllipse",!0).attr(edgeStyle);break;case 2:var g=Math.min(c,d);Interaction.shape=Interaction.paper.line(a+c*.2,b+d*.2,a+c*.8,b+d*.8).attr(edgeStyle).data("isEllipse",!1);break;case 3:Interaction.shape=Interaction.paper.sline(a+c*.1,b+d*.5,c*.8).attr(edgeStyle).data("isEllipse",!1).data("isPath",!0)}break;case 2:switch(Math.floor(Math.random()*4)){case 0:Interaction.shape=Interaction.paper.rect(a+c*.2,b+d*.2,c*.6,d*.6).attr(edgeStyle).data("isEllipse",!1).data("isPath",!1).attr("fill","#999");break;case 1:var f=Math.min(c,d)*.5;Interaction.shape=Interaction.paper.circle(a+c*.5,b+d*.5,f).attr({fill:"#fff",stroke:"#000"}).data("isEllipse",!0).attr(edgeStyle).attr("fill","#999");break;case 2:Interaction.shape=Interaction.paper.rhomboid(a+c*.2,b+d*.2,c*.2,c*.6,b*.6).attr(edgeStyle).data({isEllipse:!1,isPath:!0}).attr("fill","#999");break;case 3:Interaction.shape=Interaction.paper.triangle(a+c*.2,b+d*.8,a+c*.8,b+d*.8,a+c*.5,b+d*.2).attr(edgeStyle).data({isEllipse:!1,isPath:!0}).attr("fill","#999")}break;case 3:switch(Math.floor(Math.random()*3)){case 0:var f=Math.min(c,d)*.6;Interaction.shape=Interaction.paper.cube(a+c*.5-f*.5,b+d*.5-f*.5,f).attr(edgeStyle).data("isEllipse",!1).data("isPath",!0).attr("fill","#FFF");break;case 1:var f=Math.min(c,d);Interaction.shape=Interaction.paper.sphere(a+c*.5,b+d*.5,f*.6,"#aaa").attr(edgeStyle).data("isEllipse",!1).data("isPath",!0);break;case 2:Interaction.shape=Interaction.paper.cylinder(a+c*.2,b+d*.2,c*.6,d*.6).attr(edgeStyle).data("isEllipse",!1).data("isPath",!0)}}},Interaction.generateBowls=function(a,b){Interaction.dim0=Interaction.paper.bowl(0+.025*a,.6*b+.04*b,.2*a,.22*b).attr(edgeStyle),Interaction.dim1=Interaction.paper.bowl(.25*a+.025*a,.6*b+.04*b,.2*a,.22*b).attr(edgeStyle),Interaction.dim2=Interaction.paper.bowl(.5*a+.025*a,.6*b+.04*b,.2*a,.22*b).attr(edgeStyle),Interaction.dim3=Interaction.paper.bowl(.75*a+.025*a,.6*b+.04*b,.2*a,.22*b).attr(edgeStyle),Interaction.paper.text(Interaction.dim0.attr("x")+Interaction.dim0.attr("width")*.5,Interaction.dim0.attr("y")+Interaction.dim0.attr("height")*.5,"Boyutu\nyok").attr(textStyle),Interaction.paper.text(Interaction.dim1.attr("x")+Interaction.dim1.attr("width")*.5,Interaction.dim1.attr("y")+Interaction.dim1.attr("height")*.5,"1\nBoyultu").attr(textStyle),Interaction.paper.text(Interaction.dim2.attr("x")+Interaction.dim2.attr("width")*.5,Interaction.dim2.attr("y")+Interaction.dim2.attr("height")*.5,"2\nBoyutlu").attr(textStyle),Interaction.paper.text(Interaction.dim3.attr("x")+Interaction.dim3.attr("width")*.5,Interaction.dim3.attr("y")+Interaction.dim3.attr("height")*.5,"3\nBoyutlu").attr(textStyle),Interaction.dim0.data("dim",0),Interaction.dim1.data("dim",1),Interaction.dim2.data("dim",2),Interaction.dim3.data("dim",3)};