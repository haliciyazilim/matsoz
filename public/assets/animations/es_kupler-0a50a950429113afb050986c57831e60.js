function UnitCube(a,b,c){this.x=a,this.y=b,this.z=c,this.draw=function(a,b,c){this.shape&&this.shape.remove(),this.shape=new Path.IsometricCube(a,b,Interaction.h),this.shape.set_style(cubeStyle)}}var cubeStyle={strokeColor:"#000",strokeWidth:1,fillColor:"#ffd9d9"},Animation={pathInit:function(){Path.Cube3d=function(a,b,c,d,e){function f(a,b,d){return a.getRotatedPoint(d,b).subtract(b).multiply(1,Math.sin(Util.degreeToRadian(c))).add(b)}d=d%90-45,e==undefined&&(e=0);var g,h,i,j,k,l,m,n,o,p=b*Math.sqrt(2);g=a.add(0,p*.5),h=a.add(0,p*.5+b),i=a.add(b*Math.sqrt(2)*.5,b+p),j=a.add(b*Math.sqrt(2),b+p*.5),k=a.add(b*Math.sqrt(2),p*.5),l=a.add(b*Math.sqrt(2)*.5,0),p7=a.add(b*Math.sqrt(2)*.5,p),m=Util.centerOfPoints([h,j]),n=Util.centerOfPoints([g,k]),o=Util.centerOfPoints([g,h,i,j,k,l]),m=m.getRotatedPoint(e,o),n=n.getRotatedPoint(e,o),g=f(g,n,d).getRotatedPoint(e,o),k=f(k,n,d).getRotatedPoint(e,o),l=f(l,n,d).getRotatedPoint(e,o),p7=f(p7,n,d).getRotatedPoint(e,o),h=f(h,m,d).getRotatedPoint(e,o),i=f(i,m,d).getRotatedPoint(e,o),j=f(j,m,d).getRotatedPoint(e,o);var q=[];q.push(g),q.push(h),q.push(i),q.push(j),q.push(k),q.push(l);var r=Util.centerOfPoints(q),s=new Group,t=new Path;for(var u=0;u<q.length;u++)t.add(q[u]);return t.closed=!0,s.addChild(t),s.addChild(new Path.Line(g,p7)),s.addChild(new Path.Line(k,p7)),s.addChild(new Path.Line(i,p7)),s}},init:function(a){Animation.pathInit(),Animation.container=a,Animation.angle=0;var b=new Point(200,50),c=new AnimationHelper({yAngle:0,zAngle:0,xAngle:30});c.animate({style:{yAngle:600,zAngle:0,xAngle:-30},duration:3e3,animationType:"easeInEaseOut",update:function(){Animation.cube&&Animation.cube.remove(),Animation.cube=new Path.Cube3d(b,50,this.xAngle,this.yAngle,this.zAngle),Animation.cube.set_style(cubeStyle)}})}},Interaction={images:[{id:"isometric_paper",src:"/assets/animations/es_kupler/isometric_paper.png"}],getFramework:function(){return"paper"},pathInit:function(){Path.IsometricCube=function(a,b,c){var d,e,f,g,h,i;d=a.add(0,c*.5),e=a.add(0,c*.5+b),f=a.add(b*Math.sqrt(2)*.5,b+c),g=a.add(b*Math.sqrt(2),b+c*.5),h=a.add(b*Math.sqrt(2),c*.5),i=a.add(b*Math.sqrt(2)*.5,0),p7=a.add(b*Math.sqrt(2)*.5,c);var j=[];j.push(d),j.push(e),j.push(f),j.push(g),j.push(h),j.push(i);var k=Util.centerOfPoints(j),l=new Group,m=new Path;for(var n=0;n<j.length;n++)m.add(j[n]);return m.closed=!0,l.addChild(m),l.addChild(new Path.Line(d,p7)),l.addChild(new Path.Line(h,p7)),l.addChild(new Path.Line(f,p7)),l}},init:function(a){Interaction.pathInit(),Interaction.container=a,Main.setObjective("Yandaki yapının kaç tane eş küp ile oluşturulduğunu bulunuz."),Interaction.paper={width:$(a).width(),height:$(a).height()},Interaction.xZ=.4,Interaction.yZ=.5,Interaction.appendInput({position:"static"}),Interaction.appendButton({top:"170px",right:"95px"}),Interaction.appendStatus({top:"210px",right:"20px"});var b=document.createElement("div");$(a).append(b),$(b).append("Bu yapının hacmi&emsp;").append(Interaction.input).append("&emsp;birim küptür.").css({position:"absolute",top:"130px",right:"20px"}),Interaction.xCubes=0,Interaction.yCubes=0,Interaction.zCubes=0,Interaction.zeroPoint=new Point(150,130),Interaction.a=40,Interaction.h=30,Interaction.prepareNextQuestion()},nextQuestion:function(){if(Interaction.pause==1)return;Interaction.pause=!1,Main.interactionProject.activeLayer.removeChildren(),Interaction.isometricPaper=new Raster("isometric_paper"),Interaction.isometricPaper.position=Interaction.zeroPoint.add(17,25);var a=Interaction.zeroPoint,b=Interaction.a,c=[],d,e,f;do e=Math.floor(Math.random()*4)+2;while(Interaction.xCubes==e);do f=Math.floor(Math.random()*2)+1;while(Interaction.yCubes==f);do d=Math.floor(Math.random()*4)+1;while(Interaction.zCubes==d);Interaction.xCubes=e,Interaction.yCubes=f,Interaction.zCubes=d;for(var g=0;g<e;g++)c.push(new UnitCube(g,0,0));for(var g=0;g<f;g++)c.push(new UnitCube(0,g+1,0));for(var g=0;g<d;g++)c.push(new UnitCube(0,0,g+1));Interaction.cubes=c,UnitCube.drawCubesOneByOne(c,a,b,Interaction,500)},showCubes:function(a){if(Interaction.pause==1)return;Interaction.pause=!0;var b=new AnimationHelper({distance:0,update:function(){UnitCube.explode(Interaction.cubes,Interaction.zeroPoint,Interaction.a,this.distance,Interaction)}});b.animate({style:{distance:a},duration:1e3,update:b.update,callback:function(){Interaction.pause=!1}})},isAnswerCorrect:function(a){return a==Interaction.cubes.length?!0:!1},onCorrectAnswer:function(){Interaction.showCubes(20)},onWrongAnswer:function(){},onFail:function(){Interaction.setStatus("Yanlış cevap, doğrusu "+Interaction.cubes.length+" olacaktı.",!1),Interaction.showCubes(20)}};UnitCube.compare=function(a,b){return a.z>b.z?1:a.z<b.z?-1:a.y>b.y?1:a.y<b.y?-1:a.x>b.x?1:a.x<b.x?-1:0},UnitCube.drawCubes=function(a,b,c,d){a.sort(UnitCube.compare);for(var e=0;e<a.length;e++){var f=b.add(.5,Math.floor(-a[e].y*c)+.5);f=f.add(Math.floor(a[e].x*c*Math.sqrt(2)*.5),Math.floor(a[e].x*Interaction.h*.5)),f=f.add(Math.floor(-a[e].z*c*Math.sqrt(2)*.5),Math.floor(a[e].z*Interaction.h*.5)),a[e].draw(f,c,_s)}},UnitCube.drawCubesOneByOne=function(a,b,c,d,e){a.sort(UnitCube.compare);for(var f=0;f<a.length;f++){var g=b.add(.5,Math.floor(-a[f].y*c)+.5);g=g.add(Math.floor(a[f].x*c*Math.sqrt(2)*.5),Math.floor(a[f].x*Interaction.h*.5)),g=g.add(Math.floor(-a[f].z*c*Math.sqrt(2)*.5),Math.floor(a[f].z*Interaction.h*.5)),a[f].draw(g,c,d),a[f].shape.opacity=0,a[f].shape.animate({style:{opacity:1},delay:e*f,duration:100})}},UnitCube.explode=function(a,b,c,d,e){a.sort(UnitCube.compare);for(var f=0;f<a.length;f++){var g=b.add(a[f].x*c,-a[f].y*c);g=g.add(-a[f].z*c*e.xZ,a[f].z*c*e.yZ),g=g.add(d*a[f].x,0),g=g.add(0,-d*a[f].y),g=g.add(-a[f].z*d*e.xZ,a[f].z*d*e.yZ),a[f].draw(g,c,e)}};