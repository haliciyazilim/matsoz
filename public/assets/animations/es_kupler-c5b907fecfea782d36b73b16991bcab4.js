function UnitCube(a,b,c){this.x=a,this.y=b,this.z=c,this.draw=function(a,b,c){this.shape&&this.shape.remove(),this.shape=new Path.Cube3d(a,b,Interaction.h,45,0),this.shape.set_style(cubeStyle)}}var cubeStyle={strokeColor:"#255b63",strokeWidth:1,fillColor:"#bfe8ef"},animationCubeStyle={strokeColor:"#333",strokeWidth:1,fillColor:"#ddd"},Animation={pathInit:function(){Path.Cube3d=function(a,b,c,d,e){function f(a,b,d){return a.getRotatedPoint(d,b).subtract(b).multiply(1,Math.sin(Util.degreeToRadian(c))).add(b)}d=d%90-45,e==undefined&&(e=0);var g,h,i,j,k,l,m,n,o,p,q=b*Math.sqrt(2);g=a.add(0,q*.5),h=a.add(0,q*.5+b*Math.cos(Util.degreeToRadian(c))),i=a.add(b*Math.sqrt(2)*.5,b*Math.cos(Util.degreeToRadian(c))+q),j=a.add(b*Math.sqrt(2),b*Math.cos(Util.degreeToRadian(c))+q*.5),k=a.add(b*Math.sqrt(2),q*.5),l=a.add(b*Math.sqrt(2)*.5,0),m=a.add(b*Math.sqrt(2)*.5,q),n=Util.centerOfPoints([h,j]),o=Util.centerOfPoints([g,k]),p=Util.centerOfPoints([g,h,i,j,k,l]),n=n.getRotatedPoint(e,p),o=o.getRotatedPoint(e,p),g=f(g,o,d).getRotatedPoint(e,p),k=f(k,o,d).getRotatedPoint(e,p),l=f(l,o,d).getRotatedPoint(e,p),m=f(m,o,d).getRotatedPoint(e,p),h=f(h,n,d).getRotatedPoint(e,p),i=f(i,n,d).getRotatedPoint(e,p),j=f(j,n,d).getRotatedPoint(e,p);var r=[];r.push(g),r.push(h),r.push(i),r.push(j),r.push(k),r.push(l);var s=new Group,t=new Path;for(var u=0;u<r.length;u++)t.add(r[u]);return t.closed=!0,s.addChild(t),s.addChild(new Path.Line(g,m)),s.addChild(new Path.Line(k,m)),s.addChild(new Path.Line(i,m)),s}},init:function(a){Animation.pathInit(),Animation.container=a,Animation.angle=0;var b=new Point(340,30);Animation.a=50;var c=new AnimationHelper({yAngle:0,zAngle:0,xAngle:0});c.animate({style:{yAngle:585,zAngle:0,xAngle:30},duration:3e3,animationType:"easeInEaseOut",update:function(){Animation.cube1&&Animation.cube1.remove(),Animation.cube1=new Path.Cube3d(b,Animation.a,this.xAngle,this.yAngle,this.zAngle),Animation.cube1.set_style(animationCubeStyle)}}),c=new AnimationHelper({yAngle:0,zAngle:0,xAngle:0,position:b.add(520,-120)}),c.animate({style:{yAngle:585,zAngle:0,xAngle:30,position:b.add(Animation.a*Math.sqrt(2)*.5,Animation.a*Math.sqrt(2)*.5*Math.sin(Util.degreeToRadian(30)))},duration:3e3,delay:3e3,animationType:"easeInEaseOut",update:function(){Animation.cube2&&Animation.cube2.remove(),Animation.cube2=new Path.Cube3d(this.position,Animation.a,this.xAngle,this.yAngle,this.zAngle),Animation.cube2.set_style(animationCubeStyle)}}),c=new AnimationHelper({yAngle:0,zAngle:0,xAngle:45,position:b.add(-200,120)}),c.animate({style:{yAngle:585,zAngle:0,xAngle:30,position:b.add(-Animation.a*Math.sqrt(2)*.5,Animation.a*Math.sqrt(2)*.5*Math.sin(Util.degreeToRadian(30)))},duration:3e3,delay:6e3,animationType:"easeInEaseOut",update:function(){Animation.cube3&&Animation.cube3.remove(),Animation.cube3=new Path.Cube3d(this.position,Animation.a,this.xAngle,this.yAngle,this.zAngle),Animation.cube3.set_style(animationCubeStyle)}}),c=new AnimationHelper({yAngle:0,zAngle:0,xAngle:45,position:b.add(0,120)}),c.animate({style:{yAngle:585,zAngle:0,xAngle:30,position:b.add(0,-Animation.a*Math.cos(Util.degreeToRadian(30)))},duration:3e3,delay:9e3,animationType:"easeInEaseOut",update:function(){Animation.cube4&&Animation.cube4.remove(),Animation.cube4=new Path.Cube3d(this.position,Animation.a,this.xAngle,this.yAngle,this.zAngle),Animation.cube4.set_style(animationCubeStyle)},callback:Main.animationFinished})}},Interaction={images:[{id:"isometric_paper",src:"/assets/animations/es_kupler/isometric_paper.jpg"}],getFramework:function(){return"paper"},init:function(a){Interaction.container=a,Main.setObjective("Yandaki yapının kaç tane eş küp ile oluşturulduğunu bulunuz."),Interaction.paper={width:$(a).width(),height:$(a).height()},Interaction.xZ=.4,Interaction.yZ=.5,Interaction.appendInput({position:"static"}),Interaction.appendButton({top:"110px",right:"95px"}),Interaction.appendStatus({top:"170px",right:"20px",width:"252px",textAlign:"center"});var b=document.createElement("div");$(a).append(b),$(b).append("Bu yapının hacmi&emsp;").append(Interaction.input).append("&emsp;birim küptür.").css({position:"absolute",top:"60px",right:"20px"}),Interaction.setRandomGenerator(5),Interaction.xCubes=0,Interaction.yCubes=0,Interaction.zCubes=0,Interaction.zeroPoint=new Point(138,126),Interaction.a=35,Interaction.h=35,Interaction.prepareNextQuestion()},nextQuestion:function(a){if(Interaction.pause==1)return;Interaction.pause=!1,Main.interactionProject.activeLayer.removeChildren(),Interaction.isometricPaper=new Raster("isometric_paper"),Interaction.isometricPaper.position=new Point(Interaction.isometricPaper.width*.5,Interaction.isometricPaper.height*.5);var b=Interaction.zeroPoint,c=Interaction.a,d,e,f;do e=Math.floor(Math.random()*3)+2;while(Interaction.xCubes==e);do f=Math.floor(Math.random()*2)+1;while(Interaction.yCubes==f);do d=Math.floor(Math.random()*3)+1;while(Interaction.zCubes==d);Interaction.xCubes=e,Interaction.yCubes=f,Interaction.zCubes=d,Interaction.xCubes=e,Interaction.yCubes=f,Interaction.zCubes=d,Interaction.cubes=Interaction.generateShape(a),Interaction.pause=!0;var g=500;UnitCube.drawCubesOneByOne(Interaction.cubes,b,c,Interaction,g),setTimeout("Interaction.pause = false",g*Interaction.cubes.length)},generateShape:function(a){var b=[],c;switch(a){case 0:for(c=0;c<Interaction.xCubes;c++)b.push(new UnitCube(c-1,2,0));for(c=0;c<Interaction.yCubes;c++)b.push(new UnitCube(0,2-(c+1),0));for(c=0;c<Interaction.zCubes;c++)b.push(new UnitCube(-Math.floor(c/3),2,c%3+1));break;case 1:for(c=0;c<Interaction.xCubes;c++)b.push(new UnitCube(c-1,2,2));for(c=0;c<Interaction.yCubes;c++)b.push(new UnitCube(0,2-(c+1),2));for(c=0;c<Interaction.zCubes;c++)b.push(new UnitCube(-Math.floor(c/3),2,-c%3+1));break;case 2:for(c=0;c<Interaction.xCubes;c++)b.push(new UnitCube(c-1,0,0));for(c=0;c<Interaction.yCubes;c++)b.push(new UnitCube(0,c+1,0));for(c=0;c<Interaction.zCubes;c++)b.push(new UnitCube(c-1,0,1));break;case 3:for(c=0;c<Interaction.xCubes;c++)b.push(new UnitCube(-1,c-1,0));b.push(new UnitCube(0,0,0));for(c=0;c<Interaction.zCubes;c++)b.push(new UnitCube(1,c-1,0));break;case 4:for(c=0;c<Interaction.yCubes;c++)b.push(new UnitCube(-c,0,1));for(c=0;c<Interaction.yCubes;c++)b.push(new UnitCube(0,c,0));for(c=0;c<Interaction.zCubes;c++)b.push(new UnitCube(c,0,3));b.push(new UnitCube(0,0,2))}return b},showCubes:function(a){if(Interaction.pause==1)return;Interaction.pause=!0;var b=new AnimationHelper({distance:0,update:function(){UnitCube.explode(Interaction.cubes,Interaction.zeroPoint,Interaction.a,this.distance,Interaction)}});b.animate({style:{distance:a},duration:1e3,update:b.update,callback:function(){this.animate({style:{distance:0},duration:1e3,delay:500,update:this.update,callback:function(){Interaction.pause=!1}})}})},isAnswerCorrect:function(a){return a==Interaction.cubes.length?!0:!1},onCorrectAnswer:function(){Interaction.showCubes(15)},onWrongAnswer:function(){},onFail:function(){Interaction.setStatus("Yanlış cevap, doğrusu "+Interaction.cubes.length+" olacaktı.",!1),Interaction.showCubes(20)}};UnitCube.compare=function(a,b){return a.z>b.z?1:a.z<b.z?-1:a.y>b.y?1:a.y<b.y?-1:a.x>b.x?1:a.x<b.x?-1:0},UnitCube.drawCubes=function(a,b,c,d){a.sort(UnitCube.compare),a.sort(UnitCube.compare);var e=c;for(var f=0;f<a.length;f++){var g=b.add(.5,Math.floor(-a[f].y*c*Math.cos(Util.degreeToRadian(Interaction.h)))+.5);g=g.add(Math.floor(a[f].x*c*Math.sqrt(2)*.5),Math.floor(a[f].x*e*.5)),g=g.add(Math.floor(-a[f].z*c*Math.sqrt(2)*.5),Math.floor(a[f].z*e*.5)),a[f].draw(g,c,_s)}},UnitCube.drawCubesOneByOne=function(a,b,c,d,e){a.sort(UnitCube.compare);var f=c*Math.sin(Util.degreeToRadian(Interaction.h))*Math.sqrt(2)/2;for(var g=0;g<a.length;g++){var h=b.add(.5,Math.floor(-a[g].y*c*Math.cos(Util.degreeToRadian(Interaction.h)))+.5);h=h.add(Math.floor(a[g].x*c*Math.sqrt(2)*.5),Math.floor(a[g].x*f)),h=h.add(Math.floor(-a[g].z*c*Math.sqrt(2)*.5),Math.floor(a[g].z*f)),a[g].draw(h,c,d),a[g].shape.opacity=0,a[g].shape.animate({style:{opacity:1},delay:e*g,duration:100})}},UnitCube.explode=function(a,b,c,d,e){a.sort(UnitCube.compare),a.sort(UnitCube.compare),c+=d;var f=c*Math.sin(Util.degreeToRadian(Interaction.h))*Math.sqrt(2)/2;for(var g=0;g<a.length;g++){var h=b.add(.5,Math.floor(-a[g].y*c*Math.cos(Util.degreeToRadian(Interaction.h)))+.5);h=h.add(Math.floor(a[g].x*c*Math.sqrt(2)*.5),Math.floor(a[g].x*f)),h=h.add(Math.floor(-a[g].z*c*Math.sqrt(2)*.5),Math.floor(a[g].z*f)),a[g].draw(h,c-d,e)}};