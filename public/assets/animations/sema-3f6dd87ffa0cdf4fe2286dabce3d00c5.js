/**
 * Şema
 * 
 * Halıcı Yazılım
 * Abdullah Karacabey
 * 12.07.2012
 * 
 * 
 */
function SadeceRakam(a,b){var c=a.charCode==undefined?a.keyCode:a.charCode;return/^[0-9]+$/.test(String.fromCharCode(c))||c==0||c==13||isPassKey(c,b)?!0:!1}function isPassKey(a,b){if(b!=null)for(var c=0;c<b.length;c++)if(b[c]==String.fromCharCode(a))return!0;return!1}function SadeceRakamBlur(a,b){var c=a.target?a.target:a.srcElement,d=c.value;d=d.replace(/^\s+|\s+$/g,""),b&&(d=d.replace(/\s{2,}/g," ")),c.value=d}var semaRengi=["#ffc3c3","#ffeed0","c6f4c3","#c5e9ff","#ecccfd"],semaBorderRengi=["#c99999","#c7b188","#90c08e","#97b8c9","#b08bc1"],dropableShapeHoverStyle={fillColor:"#afa"},dropableShapeDefaultStyle={fillColor:"#fff"},Animation=function(){};Animation();var Interaction=function(){};Interaction(),Interaction.getFramework=function(){return"paper"},Animation.init=function(a){$(a).append("<img id='ornek' src='/assets/animations/sema/ornek.jpg' />"),$("#ornek").css("position","absolute").css("top","20px").hide(),$(a).append("<div id='ornekBosCerceve'>"),$("#ornekBosCerceve").css("width","758px").css("height","170px").css("position","absolute").css("top","20px"),$("#ornekBosCerceve",a).append("<img id='ornekBos1' src='/assets/animations/sema/ornek_bos_1.png' />"),$("#ornekBos1").css("position","absolute").css("left","0px"),$("#ornek").delay(1e3).show(1),$("#ornekBos1").delay(1e3).animate({left:"92px"},1e3).animate({opacity:"0"},"slow"),$("#ornekBosCerceve",a).append("<img id='ornekBos2' src='/assets/animations/sema/ornek_bos_2.png' />"),$("#ornekBos2").css("position","absolute").css("left","92px"),$("#ornekBos2").delay(2e3).animate({left:"187px"},1e3).animate({opacity:"0"},"slow"),$("#ornekBosCerceve",a).append("<img id='ornekBos3' src='/assets/animations/sema/ornek_bos_3.png' />"),$("#ornekBos3").css("position","absolute").css("left","187px"),$("#ornekBos3").delay(3e3).animate({left:"452px"},2e3).animate({opacity:"0"},"slow"),$("#ornekBosCerceve",a).append("<img id='ornekBos4' src='/assets/animations/sema/ornek_bos_4.png' />"),$("#ornekBos4").css("position","absolute").css("left","452px"),$("#ornekBos4").delay(5e3).animate({opacity:"0"},"slow")},Interaction.init=function(a){function d(a){this.name=a,this.parent=null,this.children=[],this.getTreeSize=function(){var a=1;for(var b=0;b<this.children.length;b++)a+=this.children[b].getTreeSize();return a},this.yazdir=function(){var a=Array();console.log("this.children.name"+this.name),console.log("this.children.length"+this.children.length),console.log("this.children[j].children[i].length"+this.children[1].children.length);for(var b=0;b<this.children.length;b++){console.log("ilk for içindeyim"),a.push(this.children[b].name);for(var c=0;c<this.children[b].children.length;c++)console.log("yazdır(): "+this.children[b].children[c].name),a.push(this.children[b].children[c].name)}return a},this.addChild=function(a){return this.children.push(a),a.parent=this,this}}function l(){function d(a,c,d){var e=d.getTreeSize()-1,f;switch(e){case 7:f=73;break;case 8:f=62.5;break;case 9:f=54.44}var g=245.5,h=new Path.Rectangle(g,60.5,100,40);h.strokeColor="black";var i=new PointText(g+50,85);i.content=d.name,i.paragraphStyle.justification="center";var j=d.children.length;console.log("Alt Şema Sayısı: "+j);var l=490/j/2,m=2*l,n=new Array;for(var o=0;o<j;o++)n[o]=d[d[1]+2+o];for(var o=0;o<j;o++){var p=new Group,q=l+o*m;console.log("koor"+q);var r=new Path.Rectangle(q,140.5,100,40);r.strokeColor="black",r.class="dropable";var s=d[1]+2;r.icerik=d.children[o].name,r.ebeveyn=d,r.name=null,r.bebeSayisi=d.children[o].children.length,k.addChild(r);var t=new PointText(q+50,160);t.content="",t.paragraphStyle.justification="center",p.addChild(r),p.addChild(t);var u=new Path.Line(new Point(g+50,100),new Point(q+50,140.5));u.strokeColor="black";var v=d.children[o].children.length;console.log("alt eleman sayisi "+o+": "+v),console.log("alt şema koordinat: "+r.position);for(var w=0;w<v;w++){var x=w*(f+10)+r.position.x-(f*v+10*(v-1))/2;console.log("alt eleman koordinat değişkeni: "+x);var y=new Path.Rectangle(x,r.position.y+50,f,30),z=new Group;y.bebeSayisi=0,y.ebeveyn=r,y.class="dropable",k.addChild(y),console.log("elemanlar çiziliyhor"),y.strokeColor="black",console.log("Alt eleman şekil koordinat: "+y.position);var A=new Path.Line(new Point(r.position.x,r.position.y+20),new Point(y.position.x,y.position.y-15));A.strokeColor="black",z.addChild(y),z.addChild(A)}}var B="";for(var o=0;o<d.children[o].length;o++){B+=d.children[o].name;for(var w=0;o<d.children[o].children[w].length;o++)B+=d.children[o].children[w].name}console.log("satir 228: "+B);var C=function(a){this.translate(a.delta.x,a.delta.y),k.setStyle(dropableShapeDefaultStyle);var b=project.activeLayer.hitTest([a.point.x,a.point.y],{fill:!0,stroke:!0,segments:!0,tolerance:2,"class":"dropable"});b?(this.inDropableShape=!0,this.hitShape=b.item,this.hitShape.setStyle(dropableShapeHoverStyle)):(this.inDropableShape=!1,this.hitShape=null)},D=function(a){console.log("Starta girdim"),this.ox=this.position.x,this.oy=this.position.y},E=function(a){var c,d=!1;if(this.inDropableShape==1){var f=this.children[1].content,g=this.hitShape.ebeveyn.name,h=this.hitShape.bebeSayisi,i=this.ebeveyn.name,j=this.bebeSayisi;console.log("tutulan evebeyn "+i),console.log("tutulan bebesayisi "+j),console.log("alttaki ebeveyn (content): "+this.hitShape.ebeveyn.content),console.log("alttaki ebeveyn (name): "+this.hitShape.ebeveyn.name),console.log("alttaki bebesayisi "+h),console.log("tutalan name "+this.name),console.log("alttaki name "+this.hitShape.name),i==g&&h==j&&(d=!0)}if(d==1){b++,console.log("tetkik  true if"+d),this.class=null,this.opacity=0,this.hitShape.name=this.name,console.log("asdads"+this.hitShape.name),this.hitShape.content=this.name,console.log("asdadasd: "+this.hitShape.content);var k=new PointText(this.hitShape.position);k.content=this.children[1].content,k.paragraphStyle.justification="center",k.fontSize=8,this.hitShape.class=null,this.hitShape.setStyle(dropableShapeDefaultStyle),d=!1,b==e&&$("#kontrolBtn").show()}else console.log("tetkik false if"+d),this.animate({style:{position:new Point(this.ox,this.oy)},duration:500})};console.log("elemanlar: "+d.yazdir());var F=0,G=0,H=Util.getShuffledArray(e);console.log(H);for(var w=0;w<d.children.length;w++){F=H[G],console.log("semalar 1:"),console.log(d.children[w].name);var I=new Group,J=new Path.Rectangle(F*(f+10)+10,10,f,30);J.fillColor=a,J.strokeColor=c;var K=new PointText(F*(f+10)+10+f/2,30);K.content=d.children[w].name,K.paragraphStyle.justification="center",K.fontSize=8,I.ebeveyn=d,I.bebeSayisi=d.children[w].children.length,I.name=d.children[w].name,I.class="sema",I.addChild(J),I.addChild(K),I.move=C,I.up=E,I.start=D;for(var o=0;o<d.children[w].children.length;o++){G++,F=H[G],console.log("337: "+d.children[w].children[o].name);var I=new Group,J=new Path.Rectangle(F*(f+10)+10,10,f,30);J.fillColor=a,J.strokeColor=c;var K=new PointText(F*(f+10)+10+f/2,30);K.content=d.children[w].children[o].name,K.paragraphStyle.justification="center",K.fontSize=8,I.ebeveyn=d.children[w],I.name=d.children[w].children[o].name,I.bebeSayisi=d.children[w].children[o].children.length||0,I.class="sema",I.addChild(J),I.addChild(K),I.move=C,I.up=E,I.start=D}G++}var L=new Tool;L.onMouseMove=function(a){this.item&&this.item.move(a)},L.onMouseUp=function(a){this.item&&(this.item.up(a),this.item=null)},L.onMouseDown=function(a){a.item&&a.item.class&&a.item.class=="sema"&&(this.item=a.item,this.item.start(a))},L.activate()}var a=Array();a=Util.getShuffledArray(4),console.log("139"+a);switch(a[c]){case 0:sozcuk=e;break;case 1:sozcuk=f;break;case 2:sozcuk=h;break;case 3:sozcuk=g}renkRandom=Math.floor(Math.random()*4),d(semaRengi[renkRandom],semaBorderRengi[renkRandom],sozcuk)}Main.setObjective("Yandaki sözcükleri şemada uygun yerlere fare ile sürükleyerek yerleştirip kontrol ediniz.");var b=0,c=0,e=(new d("Kitaplar")).addChild((new d("Edebiyat")).addChild(new d("Roman")).addChild(new d("Hikâye")).addChild(new d("Şiir"))).addChild((new d("Diğer")).addChild(new d("Ansiklopedi")).addChild(new d("Sözlük"))),f=(new d("İçecekler")).addChild((new d("Sıcak")).addChild(new d("Çay")).addChild(new d("Kahve")).addChild(new d("Ihlamur"))).addChild((new d("Soğuk")).addChild(new d("Ayran")).addChild(new d("Meyve Suyu")).addChild(new d("Kola"))),g=(new d("Spor")).addChild((new d("Bireysel")).addChild(new d("Güreş")).addChild(new d("Halter")).addChild(new d("Yüzme"))).addChild((new d("Takım")).addChild(new d("Futbol")).addChild(new d("Voleybol")).addChild(new d("Basketbol"))),h=(new d("Kaplar")).addChild((new d("Porselen")).addChild(new d("Tabak")).addChild(new d("Çaydanlık"))).addChild((new d("Cam")).addChild(new d("Bardak")).addChild(new d("Kâse"))).addChild((new d("Metal")).addChild(new d("Tencere")).addChild(new d("Tava")));for(var i=0;i<e.children.length;i++)var j=e.children[i];for(var i=0;i<e.children[0].children.length;i++)console.log("Edebiyatın bebeleri: "+e.children[0].children[i].name);var k=new Group;l(),$(a).append("<button id='kontrolBtn' class='next_button'>"),$("#kontrolBtn").css("position","absolute").css("right","10px").css("bottom","10px").click(function(){project.activeLayer.remove();var a=new Layer;console.log("sayi: "+b),c++,console.log("xxxxxxxxxxxxxxxxxxxxxxxsoruSirais: "+c),console.log("xxxxxxxxxxxxxxxxxxxxxxxsozcuk: "+sozcuk.name),l(),$("#kontrolBtn").hide()}).hide()};