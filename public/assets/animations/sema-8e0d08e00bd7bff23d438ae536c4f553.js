/**
 * Şemanın ilk hali (Array ile yapıldı)
 * 
 * Halıcı Yazılım
 * Abdullah Karacabey
 * 12.07.2012
 * 
 * 
 */
function SadeceRakam(a,b){var c=a.charCode==undefined?a.keyCode:a.charCode;return/^[0-9]+$/.test(String.fromCharCode(c))||c==0||c==13||isPassKey(c,b)?!0:!1}function isPassKey(a,b){if(b!=null)for(var c=0;c<b.length;c++)if(b[c]==String.fromCharCode(a))return!0;return!1}function SadeceRakamBlur(a,b){var c=a.target?a.target:a.srcElement,d=c.value;d=d.replace(/^\s+|\s+$/g,""),b&&(d=d.replace(/\s{2,}/g," ")),c.value=d}var semaRengi=["green","yellow","blue","black"],dropableShapeHoverStyle={fillColor:"#afa"},dropableShapeDefaultStyle={fillColor:"#fff"},Animation=function(){};Animation();var Interaction=function(){};Interaction(),Interaction.getFramework=function(){return"paper"},Animation.init=function(a){},Interaction.init=function(a){function e(a){this.name=a,this.parent=null,this.children=[],this.getTreeSize=function(){var a=1;for(var b=0;b<this.children.length;b++)a+=this.children[b].getTreeSize();return a},this.yazdir=function(){var a=Array();console.log("this.children.name"+this.name),console.log("this.children.length"+this.children.length),console.log("this.children[j].children[i].length"+this.children[1].children.length);for(var b=0;b<this.children.length;b++){console.log("ilk for içindeyim"),a.push(this.children[b].name);for(var c=0;c<this.children[b].children.length;c++)console.log("yazdır(): "+this.children[b].children[c].name),a.push(this.children[b].children[c].name)}return a},this.addChild=function(a){return this.children.push(a),a.parent=this,this}}function m(a,c){console.log("148"+c),console.log("149"+c.name),console.log("uzunluk "+c.getTreeSize());var d=c.getTreeSize()-1,e;switch(d){case 7:e=73;break;case 8:e=62.5;break;case 9:e=54.44}var f=245.5,g=new Path.Rectangle(f,60.5,100,40);g.strokeColor="black";var h=new PointText(f+50,85);h.content=c.name,h.paragraphStyle.justification="center";var i=c.children.length;console.log("Alt Şema Sayısı: "+i);var j=490/i/2,k=2*j,m=new Array;for(var n=0;n<i;n++)m[n]=c[c[1]+2+n];for(var n=0;n<i;n++){var o=new Group,p=j+n*k;console.log("koor"+p);var q=new Path.Rectangle(p,140.5,100,40);q.strokeColor="black",q.class="dropable";var r=c[1]+2;q.icerik=c.children[n].name,q.ebeveyn=c,q.name=null,q.bebeSayisi=c.children[n].children.length,l.addChild(q);var s=new PointText(p+50,160);s.content="",s.paragraphStyle.justification="center",o.addChild(q),o.addChild(s);var t=new Path.Line(new Point(f+50,100),new Point(p+50,140.5));t.strokeColor="black";var u=c.children[n].children.length;console.log("alt eleman sayisi "+n+": "+u),console.log("alt şema koordinat: "+q.position);for(var v=0;v<u;v++){var w=v*(e+10)+q.position.x-(e*u+10*(u-1))/2;console.log("alt eleman koordinat değişkeni: "+w);var x=new Path.Rectangle(w,q.position.y+50,e,30),y=new Group;x.bebeSayisi=0,x.ebeveyn=q,x.class="dropable",l.addChild(x),console.log("elemanlar çiziliyhor"),x.strokeColor="black",console.log("Alt eleman şekil koordinat: "+x.position);var z=new Path.Line(new Point(q.position.x,q.position.y+20),new Point(x.position.x,x.position.y-15));z.strokeColor="black",y.addChild(x),y.addChild(z)}}var A="";for(var n=0;n<c.children[n].length;n++){A+=c.children[n].name;for(var v=0;n<c.children[n].children[v].length;n++)A+=c.children[n].children[v].name}console.log("satir 228: "+A);var B=function(a){this.translate(a.delta.x,a.delta.y),l.setStyle(dropableShapeDefaultStyle);var b=project.activeLayer.hitTest([a.point.x,a.point.y],{fill:!0,stroke:!0,segments:!0,tolerance:2,"class":"dropable"});b?(this.inDropableShape=!0,this.hitShape=b.item,this.hitShape.setStyle(dropableShapeHoverStyle)):(this.inDropableShape=!1,this.hitShape=null)},C=function(a){console.log("Starta girdim"),this.ox=this.position.x,this.oy=this.position.y},D=function(a){var c,e=!1;if(this.inDropableShape==1){var f=this.children[1].content,g=this.hitShape.ebeveyn.name,h=this.hitShape.bebeSayisi,i=this.ebeveyn.name,j=this.bebeSayisi;console.log("tutulan evebeyn "+i),console.log("tutulan bebesayisi "+j),console.log("alttaki ebeveyn (content): "+this.hitShape.ebeveyn.content),console.log("alttaki ebeveyn (name): "+this.hitShape.ebeveyn.name),console.log("alttaki bebesayisi "+h),console.log("tutalan name "+this.name),console.log("alttaki name "+this.hitShape.name),i==g&&h==j&&(e=!0)}if(e==1){b++,console.log("tetkik  true if"+e),this.class=null,this.opacity=0,this.hitShape.name=this.name,console.log("asdads"+this.hitShape.name),this.hitShape.content=this.name,console.log("asdadasd: "+this.hitShape.content);var k=new PointText(this.hitShape.position);k.content=this.children[1].content,k.paragraphStyle.justification="center",k.fontSize=8,this.hitShape.class=null,this.hitShape.setStyle(dropableShapeDefaultStyle),e=!1,b==d&&$("#kontrolBtn").show()}else console.log("tetkik false if"+e),this.animate({style:{position:new Point(this.ox,this.oy)},duration:500})};console.log("elemanlar: "+c.yazdir());var E=0,F=0,G=Util.getShuffledArray(d);console.log(G);for(var v=0;v<c.children.length;v++){E=G[F],console.log("semalar 1:"),console.log(c.children[v].name);var H=new Group,I=new Path.Rectangle(E*(e+10)+10,10,e,30);I.fillColor=a;var J=new PointText(E*(e+10)+10+e/2,30);J.content=c.children[v].name,J.paragraphStyle.justification="center",J.fontSize=8,H.ebeveyn=c,H.bebeSayisi=c.children[v].children.length,H.name=c.children[v].name,H.class="sema",H.addChild(I),H.addChild(J),H.move=B,H.up=D,H.start=C;for(var n=0;n<c.children[v].children.length;n++){F++,E=G[F],console.log("337: "+c.children[v].children[n].name);var H=new Group,I=new Path.Rectangle(E*(e+10)+10,10,e,30);I.fillColor=a;var J=new PointText(E*(e+10)+10+e/2,30);J.content=c.children[v].children[n].name,J.paragraphStyle.justification="center",J.fontSize=8,H.ebeveyn=c.children[v],H.name=c.children[v].children[n].name,H.bebeSayisi=c.children[v].children[n].children.length||0,H.class="sema",H.addChild(I),H.addChild(J),H.move=B,H.up=D,H.start=C}F++}var K=new Tool;K.onMouseMove=function(a){this.item&&this.item.move(a)},K.onMouseUp=function(a){this.item&&(this.item.up(a),this.item=null)},K.onMouseDown=function(a){a.item&&a.item.class&&a.item.class=="sema"&&(this.item=a.item,this.item.start(a))},K.activate()}function n(){var a=Array();a=Util.getShuffledArray(4),console.log("139"+a);switch(a[c]){case 0:d=f;break;case 1:d=g;break;case 2:d=i;break;case 3:d=h}m(semaRengi[1],d)}Main.setObjective("Yandaki sözcükleri şemada uygun yerlere fare ile sürükleyerek yerleştirip kontrol ediniz.");var b=0,c=0,d,f=(new e("Kitaplar")).addChild((new e("Edebiyat")).addChild(new e("Roman")).addChild(new e("Hikâye")).addChild(new e("Şiir"))).addChild((new e("Diğer")).addChild(new e("Ansiklopedi")).addChild(new e("Sözlük"))),g=(new e("İçecekler")).addChild((new e("Sıcak")).addChild(new e("Çay")).addChild(new e("Kahve")).addChild(new e("Ihlamur"))).addChild((new e("Soğuk")).addChild(new e("Ayran")).addChild(new e("Meyve Suyu")).addChild(new e("Kola"))),h=(new e("Spor")).addChild((new e("Bireysel")).addChild(new e("Güreş")).addChild(new e("Halter")).addChild(new e("Yüzme"))).addChild((new e("Takım")).addChild(new e("Futbol")).addChild(new e("Voleybol")).addChild(new e("Basketbol"))),i=(new e("Kaplar")).addChild((new e("Porselen")).addChild(new e("Tabak")).addChild(new e("Çaydanlık"))).addChild((new e("Cam")).addChild(new e("Bardak")).addChild(new e("Kâse"))).addChild((new e("Metal")).addChild(new e("Tencere")).addChild(new e("Tava")));for(var j=0;j<f.children.length;j++)var k=f.children[j];for(var j=0;j<f.children[0].children.length;j++)console.log("Edebiyatın bebeleri: "+f.children[0].children[j].name);var l=new Group;console.log("145"+d),n(),$(a).append("<div id='kontrolBtn' class='next_button'>"),$("#kontrolBtn").html("Sonraki").css("position","absolute").css("height","15px").css("right","10px").css("bottom","10px").click(function(){project.activeLayer.remove();var a=new Layer;console.log("sayi: "+b),c++,console.log("xxxxxxxxxxxxxxxxxxxxxxxsoruSirais: "+c),console.log("xxxxxxxxxxxxxxxxxxxxxxxsozcuk: "+d.name),m(semaRengi[1],n())}).hide()};