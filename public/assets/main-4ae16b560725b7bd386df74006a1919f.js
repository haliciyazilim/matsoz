// JavaScript Document
function Animation(a){this.type=a,this.shape=null,this.time=null,this.data={}}var Main=function(){$(document).ready(Main.init)};Main.config={defaultLibrary:"raphael"},Main.init=function(){Main.interaction=$("#interaction_container > .interaction").get(0),Main.objective=$("#interaction_container > .objective").get(0),Main.objective.className="objective";var a;typeof Interaction.getFramework=="function"?a=Interaction.getFramework():a=Main.config.defaultLibrary,a=="raphael"?(Main.raphaelInit(),Interaction.init(Main.interaction)):a=="paper"&&(Main.scale=1,paper.install(window),Main.paperInit(),width=512,height=320,Main.interaction.innerHTML="<canvas id='interaction_canvas' class='interaction_canvas' width='"+width*Main.scale+"px' height='"+height*Main.scale+"px'></canvas>",canvas=$(".interaction_canvas").get(0),paper.setup(canvas),AnimationManager(),Interaction.init(Main.interaction))},Main.paperInit=function(){Path.Triangle=function(a,b,c){var d=new Path;return d.add([a.x,a.y]),d.add([b.x,b.y]),d.add([c.x,c.y]),d.closed=!0,d},Path.Bowl=function(a,b,c,d){var e=new Path;return e.add([a,b]),e.add([a+c,b]),e.add([a+c*.8,b+d]),e.add([a+c*.2,b+d]),e.closed=!0,e},Path.Rhomboid=function(a,b,c){var d=a.x,e=a.y,f=b.width,g=b.height,h=new Path;return h.add([d+c,e]),h.add([d+c+f,e]),h.add([d+f,e+g]),h.add([d,e+g]),h.closed=!0,h},Path.Cube=function(a,b){var c=a.x,d=a.y,e=c+b*.3,f=d+b*.3,g=new Path;return g.add([c,f]),g.add([c,f+b]),g.add([c+b,f+b]),g.add([c+b,f]),g.add([c,f]),g.add([e,d]),g.add([e+b,d]),g.add([c+b,f]),g.add([c+b,f+b]),g.add([e+b,d+b]),g.add([e+b,d]),g.add([c+b,f]),g.closed=!0,g},Path.Rhombus=function(a,b){var c=a.x,d=a.y,e=b.width,f=b.height,g=new Path;return g.add([c,d+f*.5]),g.add([c+e*.5,d]),g.add([c+e,d+f*.5]),g.add([c+e*.5,d+f]),g.closed=!0,g}},Main.raphaelInit=function(){Raphael.fn.triangle=function(a,b,c,d,e,f){var g="";g+="M"+a+","+b+"L"+c+","+d,g+="L"+e+","+f+" z";var h=this.path(g);return h.attr({x:a,y:f}),h},Raphael.fn.line=function(a,b,c,d){var e=this.path("M"+a+","+b+"L"+c+","+d);return e.attr("x",a),e.attr("y",b),e.data("isPath",!0),e},Raphael.fn.bowl=function(a,b,c,d){var e=this.path("M"+a+","+b+"L"+(a+c)+","+b+"L"+(a+c*.8)+","+(b+d)+"L"+(a+.2*c)+","+(b+d)+" z");return e.attr("x",a),e.attr("y",b),e.attr("width",c),e.attr("height",d),e},Raphael.fn.rhomboid=function(a,b,c,d,e){var f="";f+="M"+(a+c)+","+b+"L"+(a+c+d)+","+b,f+="L"+(a+d)+","+(b+e),f+="L"+a+","+(b+e)+" z";var g=this.path(f);return g.attr({x:a,y:b}),g},Raphael.fn.cube=function(a,b,c){var d=a+c*.4,e=b+c*.2,f=this.path("M"+a+","+e+"L"+a+","+(e+c)+"L"+(a+c)+","+(e+c)+"L"+(a+c)+","+e+"L"+a+","+e+"L"+d+","+b+"L"+(d+c)+","+b+"L"+(a+c)+","+e+"L"+(a+c)+","+(e+c)+"L"+(d+c)+","+(b+c)+"L"+(d+c)+","+b);return f.data("isPath",!0),f.attr("x",a),f.attr("y",b),f},Raphael.fn.rhombus=function(a,b,c,d){var e="";e+="M"+a+","+(b+d*.5),e+="L"+(a+c*.5)+","+b,e+="L"+(a+c)+","+(b+d*.5),e+="L"+(a+c*.5)+","+(b+d),e+="z";var f=this.path(e);return f.data({x:a,y:b,w:c,h:d}),f},Raphael.fn.trapezoid=function(a,b,c,d,e){var f="";f+="M"+a+","+(b+d),f+="L"+(a+(c-e)*.5)+","+b,f+="L"+(a+(c-e)*.5+e)+","+b,f+="L"+(a+c)+","+(b+d),f+=" z";var g=this.path(f);return g.data({x:a,y:b,w:c,h:d}),g},Raphael.fn.sphere=function(a,b,c,d){var e=this.ellipse(a,b,c,c).attr({fill:"r(.3,.25) white-"+d,stroke:"none"});return e.data("isEllipse",!0),e.attr("x",a),e.attr("y",b),e},Raphael.fn.sline=function(a,b,c){var d="";d+="M"+a+","+b+"L"+(a+10)+","+(b-10),d+="M"+a+","+b+"L"+(a+10)+","+(b+10),d+="M"+a+","+b+"L"+(a+c)+","+b,d+="M"+(a+c)+","+b+"L"+(a+c-10)+","+(b-10),d+="M"+(a+c)+","+b+"L"+(a+c-10)+","+(b+10);var e=this.path(d);return e.attr("x",a),e.attr("y",b),e},Raphael.fn.cylinder=function(a,b,c,d){var e,f,g,h,i="";e=a+c*.2,g=a+c*.8,f=b-d*.2,h=b-d*.2,i+="M"+a+","+b+"C"+e+","+f+","+g+","+h+","+(a+c)+","+b,e=a+c*.2,g=a+c*.8,f=b+d*.2,h=b+d*.2,i+="C"+g+","+h+","+e+","+f+","+a+","+b,i+="L"+a+","+(b+d),e=a+c*.2,g=a+c*.8,f=b+d+d*.2,h=b+d+d*.2,i+="C"+e+","+f+","+g+","+h+","+(a+c)+","+(b+d),i+="L"+(a+c)+","+b,e=a+c*.2,g=a+c*.8,f=b+d*.2,h=b+d*.2,i+="C"+g+","+h+","+e+","+f+","+a+","+b;var j=this.path(i);return j.data("isPath",!0),j.attr("x",a),j.attr("y",b),j.attr("fill","#fff"),j},Raphael.fn.fraction=function(a,b,c,d,e){var f=this.set();c2=b+e,c3=a+e*1.5,c&&(pay=this.text(a+e*5/7,b,c),pay.attr({"font-size":e}),f.push(pay)),d&&(payda=this.text(a+e*5/7,c2+e,d),payda.attr({"font-size":e}),f.push(payda));var g="M"+a+" "+c2+"L"+c3+" "+c2;return f.push(this.path(g)),f},Raphael.fn.segmentedUmbrella=function(a,b,c,d){var e=this.set();for(i=0;i<d;i++)e.push(this.path().attr({segment:[a,b,c,360*-i/d-90,360*(-i-1)/d-90]}));return e},Raphael.fn.segmentedCircle=function(a,b,c,d){var e=this.set();for(i=0;i<d;i++)e.push(this.path().attr({segment:[a,b,c,360*i/d-90,360*(i+1)/d-90]}));return e},Raphael.fn.segmentedRectangle=function(a,b,c,d,e,f){var g=this.set();for(i=0;i<e;i++)for(j=0;j<f;j++)g.push(this.rect(a+i*c/e,b+j*d/f,c/e,d/f));return g},Raphael.fn.regularPolygon=function(a,b,c,d,e,f){var g=[];for(var h=0;h<e;h++)g[h]=360/e*h;return this.equiradialPolygon(a,b,c,d,g,f)},Raphael.fn.equiradialPolygon=function(a,b,c,d,e,f){var g=Math.random()*60;f!=null&&(g=f);var h=Math.min(c,d)*.5,i=a+c*.5,j=b+d*.5,k="";for(var l=0;l<e.length;l++){k+=l==0?"M":"L";var m=Util.degreeToRadians(g+e[l]),n=i+h*Math.cos(m),o=j+h*Math.sin(m);k+=n+","+o}return k+="z",this.path(k)}},Main.setObjective=function(a){Main.objective.innerHTML=a},Main();var Util={isInteger:function(a){var b=/^\d+$/;return b.test(val)},findDistance:function(a,b,c,d){var e=a-c,f=b-d;return Math.sqrt(e*e+f*f)},findAngle:function(a,b,c,d){return b==d?a>c?Math.PI:0:a==c?b>d?Math.PI/2:3*Math.PI/2:(angle=-Math.atan((d-b)/(c-a)),c<a?angle+=Math.PI:d>b&&(angle+=2*Math.PI),angle)},radianToDegree:function(a){return Math.round(a*(180/Math.PI))},degreeToRadians:function(a){return a*(Math.PI/180)},formatNumber:function(a,b){return Math.floor(a*b*10)/(b*10)},rand01:function(){return Math.floor(Math.random()*2)}},AnimationManager=function(){AnimationManager.animations=[],console.log("AnimationManager is initialized"),view.onFrame=AnimationManager.onFrame};AnimationManager.onFrame=function(a){for(var b=0;b<AnimationManager.animations.length;b++){var c=AnimationManager.animations[b];c.startTime==null&&(c.startTime=a.time);var d=!1;c.count++,c.lastTime=a.time;switch(c.type){case"translate":var e,f;e=c.data.first_position.x+c.data.delta.x*(a.time-c.startTime),f=c.data.first_position.y+c.data.delta.y*(a.time-c.startTime),c.shape.position=[e,f]}console.log(a.time,c.startTime,c.time),a.time-c.startTime>c.time/1e3&&(c.shape.position.x=c.data.first_position.x+c.data.delta.x*c.time/1e3,c.shape.position.y=c.data.first_position.y+c.data.delta.y*c.time/1e3,AnimationManager.animations.splice(b,1))}},AnimationManager.translate=function(a,b,c){var d=new Animation("translate");d.shape=a,d.data.first_position={x:a.position.x,y:a.position.y},d.data.delta={},d.data.delta.x=b.x/c*1e3,d.data.delta.y=b.y/c*1e3,console.log(d.data.first_position),d.time=c,d.startTime=null,d.lastTime=null,AnimationManager.animations.push(d)};